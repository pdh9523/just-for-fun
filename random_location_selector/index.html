<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8"/>
	<title>Kakao 지도 시작하기</title>
</head>

<body>
    <button onclick="fetchRandomLocation()">랜덤 굴리기</button>
	<div id="map" style="width:500px;height:400px;"></div>
    <p id ="location-info"></p>
	<script type="text/javascript" src=//dapi.kakao.com/v2/maps/sdk.js?appkey={YOUR_API_KEY}&libraries=services"></script>

	<script>
		var container = document.getElementById('map');
		var options = {
			center: new kakao.maps.LatLng(33.450701, 126.570667),
			level: 3
		};

		var map = new kakao.maps.Map(container, options);

        function getRandomLocation() {
            let lat = (Math.random() * (38-34.5) + 34.5).toFixed(4)
            let lng = (Math.random() * (128.3 - 126.5) + 126.6).toFixed(4)
            return {
                lat: parseFloat(lat),
                lng: parseFloat(lng)
            }
        }

        function fetchRandomLocation() {
            let location = getRandomLocation();
            var geocoder = new kakao.maps.services.Geocoder();
            geocoder.coord2Address(location.lng, location.lat, function(result, status) {
                if (status === kakao.maps.services.Status.OK) {
                    let address = result[0]?.address?.address_name || "주소 정보를 찾을 수 없습니다.";
                    updateMap(location.lat, location.lng, address)
                }
            })
            document.getElementById("location-info").innerText = `위도: ${location.lat}, 경도: ${location.lng}`
        }
        
        function updateMap(lat, lng, address) {
            var container = document.getElementById('map');
            var options = {
                center: new kakao.maps.LatLng(lat, lng),
                level: 3
            };

            var marker = new kakao.maps.Marker({
                position: new kakao.maps.LatLng(lat, lng)
            });

            var infowindow = new kakao.maps.InfoWindow({
                content: `<div style='padding:5px; width:100%'>${address}</div>`
            });

		    var map = new kakao.maps.Map(container, options);

            infowindow.open(map, marker);
            marker.setMap(map);
        }
	</script>
</body>
</html>